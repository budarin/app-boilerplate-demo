<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWA Circle</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { min-height: 100vh; background: #f5f5f5; }
        
        .circle {
            width: 100px;
            height: 100px;
            background: #3498db;
            border-radius: 50%;
            position: fixed;
            left: 50%;
            transform: translateX(-50%);
            top: var(--circle-top, 50vh);
        }
        
        .debug {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            font-family: monospace;
            font-size: 11px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="circle"></div>
    <div class="debug" id="debug">Коснись экрана...</div>

    <script>
        let viewportOffsetTop = null;

        document.addEventListener('touchstart', (e) => {
            const touch = e.touches[0];
            
            // Координаты относительно viewport
            const clientY = touch.clientY;
            
            // Координаты относительно физического экрана
            const screenY = touch.screenY;
            
            // Вычисляем смещение viewport от верха экрана
            viewportOffsetTop = screenY - clientY;
            
            updateCirclePosition();
            
            document.getElementById('debug').innerHTML = `
clientY: ${clientY.toFixed(1)}px<br>
screenY: ${screenY.toFixed(1)}px<br>
viewport offset: ${viewportOffsetTop.toFixed(1)}px
            `;
        }, { passive: true });

        function updateCirclePosition() {
            if (viewportOffsetTop === null) return;
            
            const screenHeight = window.screen.height;
            const circleHeight = 100;
            
            // Центр физического экрана
            const screenCenter = screenHeight / 2;
            
            // Позиция круга: центр экрана - смещение viewport - половина круга
            const topPosition = screenCenter - viewportOffsetTop - (circleHeight / 2);
            
            document.documentElement.style.setProperty(
                '--circle-top',
                `${Math.round(topPosition)}px`
            );
        }

        window.addEventListener('resize', updateCirclePosition);
    </script>
</body>
</html>
